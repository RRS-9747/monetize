<!DOCTYPE html>
<html>
<head>
    <title>Reward Verified!</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding-top: 50px; background: #2c3e50; color: white; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 2s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <h1>Support Verified!</h1>
    <p>Giving your reward and returning you to the game...</p>
    <div class="loader"></div>

    <script>
        // Extract parameters from the URL
        const params = new URLSearchParams(window.location.search);
        const uuid = params.get('puid');
        const ip = params.get('ip');
        const port = params.get('port');
        const secret = params.get('secret');
        const provider = params.get('provider'); // 'lootlabs' or 'shrinkme'

        if (uuid && ip && port && secret) {
            // Construct the Minecraft Server's Postback URL
            const postbackUrl = `http://${ip}:${port}/${provider}?alias=${uuid}&click_id=${uuid}&secret=${secret}`;

            // Send the signal. 'keepalive: true' ensures it finishes even if tab closes.
            fetch(postbackUrl, { mode: 'no-cors', keepalive: true })
                .then(() => {
                    setTimeout(() => { window.close(); }, 1500);
                })
                .catch(() => {
                    document.body.innerHTML = "<h1>Error</h1><p>Could not contact the Minecraft server. Please check your IP/Port.</p>";
                });
        }
    </script>
</body>
</html>
